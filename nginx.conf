worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/json;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;  # Can leave as localhost for Render

        # ===============================
        # User Service (Deployed on Render)
        # ===============================
        location /api/users {
            proxy_pass https://user-services-train-ticket-management.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        location /api/login {
            proxy_pass https://user-services-train-ticket-management.onrender.com/api/login;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        location /api/admins {
            proxy_pass https://user-services-train-ticket-management.onrender.com/api/admins;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        # ===============================
        # Train Service (Deployed on Render)
        # ===============================
        location /api/train {
            proxy_pass https://user-services-train-ticket-management-bq5j.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        location /api/station {
            proxy_pass https://user-services-train-ticket-management-bq5j.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        location /api/schedule {
            proxy_pass https://user-services-train-ticket-management-bq5j.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        # ===============================
        # Ticket Service (Deployed on Render)
        # ===============================
        location /api/findTrain {
            proxy_pass https://ticket-service-train-ticket-management.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }

        location /api/ticket {
            proxy_pass https://ticket-service-train-ticket-management.onrender.com;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_ssl_server_name on;
        }
    }
}
